Return-Path: <linux-xfs+bounces-25764-lists+linux-xfs=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-xfs@lfdr.de
Delivered-To: lists+linux-xfs@lfdr.de
Received: from sv.mirrors.kernel.org (sv.mirrors.kernel.org [IPv6:2604:1380:45e3:2400::1])
	by mail.lfdr.de (Postfix) with ESMTPS id 2247AB84086
	for <lists+linux-xfs@lfdr.de>; Thu, 18 Sep 2025 12:21:21 +0200 (CEST)
Received: from smtp.subspace.kernel.org (relay.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-ECDSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by sv.mirrors.kernel.org (Postfix) with ESMTPS id 8D733521571
	for <lists+linux-xfs@lfdr.de>; Thu, 18 Sep 2025 10:20:44 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 6EA03263F4A;
	Thu, 18 Sep 2025 10:16:36 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (1024-bit key) header.d=sharp.fm header.i=@sharp.fm header.b="hloyD2fY"
X-Original-To: linux-xfs@vger.kernel.org
Received: from aurora.sharp.fm (aurora.sharp.fm [159.69.230.166])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 977E422F74D
	for <linux-xfs@vger.kernel.org>; Thu, 18 Sep 2025 10:16:34 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=159.69.230.166
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1758190596; cv=none; b=gyDt5VWRTwEVUTokly0s2BJi6BDWUYNqsgJDvBDx7ye/MeLEMb9V81eeXoHeaVISYXDgzqSSA9BaXIoxOOKkBye/56kleChnLDDI3ZeiC+5Vd+3qUd6lXrRL8iFAZmAuRSEU0GW7dqo9pUWQxAsf2HddUpvkJZw/Mqg4lJXijPc=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1758190596; c=relaxed/simple;
	bh=lpGohGMsg3CekeTSm8DoxnSjawC9J3+rxDCtf8ExlGg=;
	h=From:Content-Type:Mime-Version:Subject:Message-Id:Date:To; b=WijorO6tfqzU1DA7S9zb1LvSUEwOYFo5FlpgItJ+kUV45jeh+mgv3J2JGoBsW22CSwySNmlHAismP3TWlszK+q/39E/UzoIQPF9LW59LLGehQTXiSbQZCiLkI2f4CP3Lt6ivMhcdbMTjWC6Sqq1OzZbSiLabKvZtK3wmW96dTZw=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=sharp.fm; spf=pass smtp.mailfrom=sharp.fm; dkim=pass (1024-bit key) header.d=sharp.fm header.i=@sharp.fm header.b=hloyD2fY; arc=none smtp.client-ip=159.69.230.166
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=reject dis=none) header.from=sharp.fm
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=sharp.fm
Received: from aurora.sharp.fm (localhost [IPv6:::1])
	by aurora.sharp.fm (Postfix) with ESMTP id AD26A6038F29
	for <linux-xfs@vger.kernel.org>; Thu, 18 Sep 2025 11:16:30 +0100 (BST)
DMARC-Filter: OpenDMARC Filter v1.4.2 aurora.sharp.fm AD26A6038F29
Authentication-Results: aurora.sharp.fm; dmarc=pass (p=reject dis=none) header.from=sharp.fm
Authentication-Results: aurora.sharp.fm; spf=pass smtp.mailfrom=sharp.fm
DKIM-Filter: OpenDKIM Filter v2.11.0 aurora.sharp.fm AD26A6038F29
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=sharp.fm; s=default;
	t=1758190591; bh=ev3V4zAf/LEPcEA1AljHZs0KfT/N9zAF6yZhzw65Qsg=;
	h=From:Subject:Date:To:From;
	b=hloyD2fYbwB4xEGVmiEJk2v2/bFRR1l7vPNzaS+0XW63e+1wQDJfxX3ZNmGBiWBkL
	 gndSslc/s0aVuD/co60kuESAQbDAgWUO+Odp4TY1Ynn+L/uIgkkp06ckC3zefPSwtz
	 GQisyZEh/Q6SGmffkoeStcCKsxMjILpd5M6bWjGo=
Received: from smtpclient.apple ([2a07:244:44:3b01:acdb:7895:92e3:3cb])
	by aurora.sharp.fm with ESMTPSA
	id OTXqEP7by2iTmQkA8QRZbw
	(envelope-from <minfrin@sharp.fm>)
	for <linux-xfs@vger.kernel.org>; Thu, 18 Sep 2025 11:16:30 +0100
From: Graham Leggett <minfrin@sharp.fm>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Precedence: bulk
X-Mailing-List: linux-xfs@vger.kernel.org
List-Id: <linux-xfs.vger.kernel.org>
List-Subscribe: <mailto:linux-xfs+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-xfs+unsubscribe@vger.kernel.org>
Mime-Version: 1.0 (Mac OS X Mail 16.0 \(3826.700.81\))
Subject: Crash in xfs_repair while repairing corrupted disk
Message-Id: <BF6155D3-0065-418F-905D-948B74C4434A@sharp.fm>
Date: Thu, 18 Sep 2025 11:16:29 +0100
To: linux-xfs@vger.kernel.org
X-Mailer: Apple Mail (2.3826.700.81)

Hi all,

I just encountered a crash while repairing a damaged disk. The disk has =
been in a machine with a failing power supply, which caused the drive to =
power down at random intervals. Power supply replaced, disk repair =
attempted, leading to this crash:

Core was generated by `xfs_repair -l /dev/vde /dev/vdd'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  get_inode_parent (irec=3D0x7f40ae1cdaf0, offset=3D50) at =
/usr/src/debug/xfsprogs-6.4.0-5.el9.x86_64/repair/incore_ino.c:713
713 if (ptbl->pmask & (1ULL << offset))  {
[Current thread is 1 (LWP 2644)]
(gdb) print ptbl
$1 =3D (parent_list_t *) 0x0
(gdb)=20

In essence the variable ptbl is assumed to be non NULL but is.

This was the second attempt to repair the file system, the first attempt =
to repair exited with the following error:

fatal error -- couldn't map inode 1261234229, err =3D 117

This is an older version of xfsprogs as shipped with EL9, just verifying =
this has been fixed.

Regards,
Graham
--




